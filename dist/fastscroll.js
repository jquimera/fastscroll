'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.default=undefined;var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _delegatejs=require('delegatejs');var _delegatejs2=_interopRequireDefault(_delegatejs);var _eventdispatcher=require('eventdispatcher');var _eventdispatcher2=_interopRequireDefault(_eventdispatcher);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _defaults(obj,defaults){var keys=Object.getOwnPropertyNames(defaults);for(var i=0;i<keys.length;i++){var key=keys[i];var value=Object.getOwnPropertyDescriptor(defaults,key);if(value&&value.configurable&&obj[key]===undefined){Object.defineProperty(obj,key,value)}}return obj}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):_defaults(subClass,superClass)}var _instanceMap={};var FastScroll=function(_EventDispatcher){_inherits(FastScroll,_EventDispatcher);function FastScroll(){var scrollTarget=arguments.length<=0||arguments[0]===undefined?window:arguments[0];var _this;var options=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];_classCallCheck(this,FastScroll);var instance=(_this=_possibleConstructorReturn(this,_EventDispatcher.call(this)),_this);if(FastScroll.hasScrollTarget(scrollTarget)){var _ret;return _ret=instance,_possibleConstructorReturn(_this,_ret)}_this.scrollTarget=scrollTarget;_this.options=options;_instanceMap[scrollTarget]=instance;if(!_this.options.hasOwnProperty('animationFrame')){_this.options.animationFrame=true}FastScroll.unprefixAnimationFrame();_this.destroyed=false;_this.scrollY=0;_this.scrollX=0;_this.lastScrollY=0;_this.lastScrollX=0;_this.timeout=0;_this.speedY=0;_this.speedX=0;_this.stopFrames=5;_this.currentStopFrames=0;_this.firstRender=true;_this.animationFrame=true;// this.lastEvent= {
//   type: null,
//   scrollY: 0,
//   scrollX: 0
// };
_this.scrolling=false;_this.init();return _this}FastScroll.prototype.init=function init(){this.updateScrollPosition=this.scrollTarget===window?(0,_delegatejs2.default)(this,this.updateWindowScrollPosition):(0,_delegatejs2.default)(this,this.updateElementScrollPosition);this.updateScrollPosition();this.onScroll=(0,_delegatejs2.default)(this,this.onScroll);this.onNextFrame=(0,_delegatejs2.default)(this,this.onNextFrame);if(this.scrollTarget.addEventListener){// this.scrollTarget.addEventListener('mousewheel', this.onScroll, Can.passiveEvents ? { passive: true } : false);
this.scrollTarget.addEventListener('scroll',this.onScroll,Can.passiveEvents?{passive:true}:false)}else if(this.scrollTarget.attachEvent){// this.scrollTarget.attachEvent('onmousewheel', this.onScroll);
this.scrollTarget.attachEvent('scroll',this.onScroll)}};FastScroll.prototype.destroy=function destroy(){if(!this.destroyed){this.cancelNextFrame();_EventDispatcher.prototype.destroy.call(this);if(this.scrollTarget.addEventListener){// this.scrollTarget.removeEventListener('mousewheel', this.onScroll);
this.scrollTarget.removeEventListener('scroll',this.onScroll)}else if(this.scrollTarget.attachEvent){// this.scrollTarget.detachEvent('onmousewheel', this.onScroll);
this.scrollTarget.detachEvent('scroll',this.onScroll)}this.onScroll=null;this.updateScrollPosition=null;this.onNextFrame=null;this.scrollTarget=null;this.destroyed=true}};FastScroll.prototype.getAttributes=function getAttributes(){return{scrollY:this.scrollY,scrollX:this.scrollX,speedY:this.speedY,speedX:this.speedX,angle:0,directionY:this.speedY===0?FastScroll.NONE:this.speedY>0?FastScroll.UP:FastScroll.DOWN,directionX:this.speedX===0?FastScroll.NONE:this.speedX>0?FastScroll.RIGHT:FastScroll.LEFT}};FastScroll.prototype.updateWindowScrollPosition=function updateWindowScrollPosition(){this.scrollY=window.scrollY||window.pageYOffset||0;this.scrollX=window.scrollX||window.pageXOffset||0};FastScroll.prototype.updateElementScrollPosition=function updateElementScrollPosition(){this.scrollY=this.scrollTarget.scrollTop;this.scrollX=this.scrollTarget.scrollLeft};FastScroll.prototype.onScroll=function onScroll(){this.currentStopFrames=0;if(this.firstRender){this.firstRender=false;if(this.scrollY>1){this.updateScrollPosition();this.dispatchEvent(FastScroll.EVENT_SCROLL_PROGRESS);return}}if(!this.scrolling){this.scrolling=true;this.dispatchEvent(FastScroll.EVENT_SCROLL_START);if(this.options.animationFrame){this.nextFrameID=window.requestAnimationFrame(this.onNextFrame)}else{clearTimeout(this.timeout);this.onNextFrame();var self=this;this.timeout=setTimeout(function(){self.onScrollStop()},100)}}};FastScroll.prototype.onNextFrame=function onNextFrame(){this.updateScrollPosition();this.speedY=this.lastScrollY-this.scrollY;this.speedX=this.lastScrollX-this.scrollX;this.lastScrollY=this.scrollY;this.lastScrollX=this.scrollX;if(this.options.animationFrame&&this.scrolling&&this.speedY===0&&this.currentStopFrames++>this.stopFrames){this.onScrollStop();return}this.dispatchEvent(FastScroll.EVENT_SCROLL_PROGRESS);if(this.options.animationFrame){this.nextFrameID=requestAnimationFrame(this.onNextFrame)}};FastScroll.prototype.onScrollStop=function onScrollStop(){this.scrolling=false;if(this.options.animationFrame){this.cancelNextFrame();this.currentStopFrames=0}this.dispatchEvent(FastScroll.EVENT_SCROLL_STOP)};FastScroll.prototype.cancelNextFrame=function cancelNextFrame(){window.cancelAnimationFrame(this.nextFrameID)};// dispatchEvent (event) {
//   super.dispatchEvent(event, {target: this.scrollTarget});
// }
_createClass(FastScroll,[{key:'attr',get:function get(){return this.getAttributes()}}]);return FastScroll}(_eventdispatcher2.default);FastScroll.getInstance=function(scrollTarget,options){if(!_instanceMap[scrollTarget]){_instanceMap[scrollTarget]=new FastScroll(scrollTarget,options)}return _instanceMap[scrollTarget]};FastScroll.hasInstance=function(scrollTarget){return _instanceMap[scrollTarget]};FastScroll.hasScrollTarget=FastScroll.hasInstance;FastScroll.clearInstance=function(){var scrollTarget=arguments.length<=0||arguments[0]===undefined?window:arguments[0];if(FastScroll.hasInstance(scrollTarget)){FastScroll.getInstance(scrollTarget).destroy();delete _instanceMap[scrollTarget]}};FastScroll.unprefixAnimationFrame=function(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame};FastScroll.UP='up';FastScroll.DOWN='down';FastScroll.NONE='none';FastScroll.LEFT='left';FastScroll.RIGHT='right';FastScroll.EVENT_SCROLL_PROGRESS='scroll:progress';FastScroll.EVENT_SCROLL_START='scroll:start';FastScroll.EVENT_SCROLL_STOP='scroll:stop';exports.default=FastScroll;var Can=function(){function Can(){_classCallCheck(this,Can);this._passiveEvents=null}_createClass(Can,[{key:'animationFrame',get:function get(){return true;// console.log((window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame) )
//return typeof (window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame) === 'function';
}},{key:'passiveEvents',get:function get(){var _this2=this;if(!this._passiveEvents){return this._passiveEvents}this._supportsPassive=false;try{var opts=Object.defineProperty({},'passive',{get:function get(){_this2._supportsPassive=true}});window.addEventListener('test',null,opts)}catch(e){}}}]);return Can}();module.exports=exports['default'];